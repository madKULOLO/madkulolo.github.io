function copyToClipboard(text) {
    navigator.clipboard.writeText(text).catch(function(err) {
        console.error('–î–µ–¥—É—Å —Ä—É–∏–Ω–∞, –¥–∞–ª –∂–∏–¥–∫–æ–≥–æ. –û—à–∏–±–∫–∞: ', err);
    });
}

function updateBackButton(event) {
    event.preventDefault();
    checkStreamStatus().then(() => {
        const backButton = document.getElementById("backToHome");
        window.location.href = backButton.href;
    });
}

async function checkStreamStatus() {
    const channelName = "madkulolo";
    const clientId = "gp762nuuoqcoxypju8c569th9wz7q5";
    const accessToken = "nicnpw2xfm36f0fewnz1dtzww9i3hj";

    try {
        const response = await fetch(`https://api.twitch.tv/helix/streams?user_login=${channelName}`, {
            headers: {
                'Client-ID': clientId,
                'Authorization': `Bearer ${accessToken}`
            }
        });
        const data = await response.json();
        const stream = data.data[0];
        const isLive = stream && stream.type === "live";
        const backButton = document.getElementById("backToHome");
        const backText = document.getElementById("backText");
        const popupBanner = document.getElementById("popupBanner");

        if (backButton && backText) {
            if (isLive) {
                backButton.href = "https://www.twitch.tv/madkulolo";
                backText.textContent = "üî¥–ù–∞–∑–∞–¥ –∫ –î–µ–¥—É –Ω–∞ —Å—Ç—Ä–∏–º";
                backButton.style.backgroundColor = "#ff0000";
            } else {
                backButton.href = "/";
                backText.textContent = "–ù–∞–∑–∞–¥ –∫ –î–µ–¥—É –¥–æ–º–æ–π üè•";
                backButton.style.backgroundColor = "#ff4545";
            }
        }

        if (popupBanner) {
            if (isLive) {
                popupBanner.style.display = "block";
            } else {
                popupBanner.style.display = "none";
            }
        }
    } catch (error) {
        console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å—Ç—Ä–∏–º–∞:", error);
    }
}

document.addEventListener("DOMContentLoaded", checkStreamStatus);

function closeBanner() {
    document.getElementById('popupBanner').style.display = 'none';
}

window.addEventListener('load', function() {
    document.getElementById('loading').style.display = 'none';
});

document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('commandSearch');
    if (searchInput) {
        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            if (searchTerm === '') {
                document.querySelectorAll('.command-category').forEach(category => {
                    const commandList = category.querySelector('.command-list');
                    if (category.classList.contains('expanded')) {
                        commandList.classList.add('show');
                    } else {
                        commandList.classList.remove('show');
                    }
                    commandList.querySelectorAll('ul li').forEach(li => li.style.display = 'list-item');
                });
            } else {
                document.querySelectorAll('.command-category').forEach(category => {
                    const commandList = category.querySelector('.command-list');
                    const lis = commandList.querySelectorAll('ul li');
                    const matchingLis = Array.from(lis).filter(li => li.textContent.toLowerCase().includes(searchTerm));
                    if (matchingLis.length > 0) {
                        commandList.classList.add('show');
                        lis.forEach(li => {
                            if (li.textContent.toLowerCase().includes(searchTerm)) {
                                li.style.display = 'list-item';
                            } else {
                                li.style.display = 'none';
                            }
                        });
                    } else {
                        commandList.classList.remove('show');
                    }
                });
            }
        });
    }

    const categoryTitles = document.querySelectorAll('.category-title');
    categoryTitles.forEach(title => {
        title.addEventListener('click', function() {
            const commandList = this.nextElementSibling;
            commandList.classList.toggle('show');
            this.parentElement.classList.toggle('expanded');
        });
    });
});

function triggerConfetti() {
    for (let i = 0; i < 80; i++) {
        createExplodingParticle('confetti');
    }
}

function triggerTrollConfetti() {
    for (let i = 0; i < 30; i++) {
        createExplodingParticle('troll');
    }
}

function createExplodingParticle(type) {
    const angle = Math.random() * 2 * Math.PI; 
    const velocity = Math.random() * 6 + 4; 
    const duration = 1200 + Math.random() * 600;
    const start = performance.now();

    const startX = window.innerWidth / 2;
    const startY = window.innerHeight / 2;

    let el;
    if (type === 'confetti') {
        const colors = ['#ff0000', '#00ff00', '#0000ff', '#ff00ff', '#00ffff', '#ffff00'];
        el = document.createElement('div');
        el.className = 'custom-confetti';
        el.style.background = colors[Math.floor(Math.random() * colors.length)];
        const size = Math.random() * 8 + 8;
        el.style.width = el.style.height = size + 'px';
        el.style.borderRadius = '50%';
    } else {
        el = document.createElement('img');
        el.src = './images/trollface.png';
        el.className = 'troll-confetti';
        const size = Math.random() * 32 + 32;
        el.style.width = el.style.height = size + 'px';
    }

    el.style.position = 'fixed';
    el.style.left = startX + 'px';
    el.style.top = startY + 'px';
    el.style.opacity = Math.random() * 0.5 + 0.7;
    el.style.pointerEvents = 'none';
    el.style.zIndex = 99999;
    document.body.appendChild(el);

    function animate(now) {
        const elapsed = now - start;
        const progress = elapsed / duration;
        if (progress > 1) {
            el.remove();
            return;
        }
        const distance = velocity * elapsed / 16 * (1 - progress * 0.5);
        const x = startX + Math.cos(angle) * distance;
        const y = startY + Math.sin(angle) * distance;
        el.style.left = x + 'px';
        el.style.top = y + 'px';
        el.style.opacity = (1 - progress) * 0.9;
        requestAnimationFrame(animate);
    }
    requestAnimationFrame(animate);
}
document.addEventListener('DOMContentLoaded', function() {
    const loadingTexts = [
        "–î–µ–¥–æ–≤—ã —è–∏—á–∫–∏...",
        "–ñ–¥–∏ –ø–∞—Å—Ö–∞–ª–∫—É",
        "–ö–£–õ–û–ö–û–õ–î–ò–ú",
        "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–µ–¥–æ–≤—Å–∫–∏—Ö –ø—Ä–∏–∫–æ–ª–æ–≤...",
        "–î–µ–¥ –∏—â–µ—Ç —Å–∞–π—Ç",
        "–î–û–ù–ê–¢–¨ –ù–ê –î–ï–î–ê!",
        ".üê£.",
        "–ê –≤–æ–æ—Ç –≤ –Ω–∞—à–µ –≤—Ä–µ–º—è...",
        "–¢–µ–±–µ –æ–Ω —Ç–æ–∂–µ –∫–∏–¥–∞–ª –ø–∏—Å—é–Ω?"
    ];

    const loadingElement = document.getElementById('loading');
    if (loadingElement) {
        const randomIndex = Math.floor(Math.random() * loadingTexts.length);
        const randomText = loadingTexts[randomIndex];
        loadingElement.setAttribute('data-text', randomText);
    }
});
function insertDedMarquee() {
    const marquee = document.createElement('marquee');
    marquee.className = 'retro-marquee';
    marquee.setAttribute('behavior', 'scroll');
    marquee.setAttribute('direction', 'left');
    marquee.innerHTML = '–ü–û–î–î–ï–†–ñ–ò –î–ï–î–ê! –î–ï–î –õ–£–ß–®–ò–ô! –î–ï–î–£ –ù–£–ñ–ù–´ –î–ï–ù–¨–ì–ò –î–û –ü–ï–ù–°–ò–ò! –Æ–ó–ê–ô, DOCTYPE –•–¢–ú–õ, CSS –ò JS, –ß–¢–û–ë–´ –ü–û–ú–û–ß–¨ –î–ï–î–£! –î–ï–î –°–¢–†–ò–ú–ò–¢ –ù–ê TWITCH, –ü–û–î–ü–ò–®–ò–°–¨ –ù–ê –ù–Å–ì–û! –î–ï–î –•–û–ß–ï–¢ –ö–£–ü–ò–¢–¨ –ù–û–í–´–ô –ö–û–ú–ü, –ü–û–ú–û–ì–ò –ï–ú–£!';
    document.body.insertAdjacentElement('afterbegin', marquee);
}

document.addEventListener('DOMContentLoaded', insertDedMarquee);